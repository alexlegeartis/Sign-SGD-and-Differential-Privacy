From Section 3.3 (\textit{``Numerically stable computations``}) of \cite{mironov2019SGM}, for each integer $\alpha \geq 1$, SGM applied to a function with $\Delta_2\leq1$ is $(\alpha, \eps_R)$-RDP for the following $\eps_R$:
\begin{equation}\label{eq:renyi_bound}
\eps_R = \frac{1}{\alpha - 1} \log\left(\sum_{k=0}^{\alpha} {\alpha \choose k}  (1-q)^{\alpha-k}q^{k} \exp\left(\frac{k^2 - k}{2\sigma^2}\right)\right).
\end{equation}

Clearly, if $\Delta_2 > 1$ for a mechanism, $\sigma := \Delta_2 \sigma$ will deliver the same $(\alpha, \eps_R)$-RDP.

If an $(\alpha, \eps_R)$-RPD mechanism is applied $T$ times, by adaptive sequential composition \cite{Mironov2017}, we get $(\alpha, T\eps_R)$-RDP of the procedure. From \textit{Proposition 3} from \cite{Mironov2017}, it follows that the procedure is $(\eps_R + \frac{\log1/\delta}{\alpha - 1}, \delta)$-differentially private for any $0 \leq \delta \leq 1$. Thus, the procedure is $(\eps, \delta)$-differntial privacy, if $(\alpha, \eps_R)$ satisfy:

\begin{equation}\label{eq:privacy_requirement}
\eps_R \leq \eps/T - \frac{\log 1/\delta}{T(\alpha - 1)}.
\end{equation}

As convergence of the algorithm depends only on $\sigma$, while $\alpha$ is an internal parameter, we are interested in finding the minimal $\sigma$. This we achieve via grid search on integer $1\leq \alpha \leq 20$ and $0.5 \leq \sigma$. An example can be seen on \ref{fig:grid_sigma}.

\begin{proposition}\label{prop:dp_guarantee}
Let $(X, Y)$ be a database and $q$ be a sampling rate. If the DP-SIGN compressor is run $T$ times on $(X, Y)$ with sampling rate $q$, clipping level $C$, and noise parameter $\sigma$ chosen to satisfy \eqref{eq:renyi_bound} and \eqref{eq:privacy_requirement} for some integer $\alpha \in [1,20]$, then the entire procedure is $(\eps, \delta)$-differentially private.
\end{proposition}

\subsection{Constructing DP-SIGN}
\newcommand{\gradg}{\boldsymbol{g}}
\begin{algorithm}
    \caption{DP-SIGN compressor}
    \label{dp-sign-precise}
    \begin{algorithmic}
        \STATE \textbf{Input}: independent gradient $\boldsymbol{g}$, $(\eps, \delta)$-privacy requirement, number of iterations $T$, sampling rate $q$, clipping level $C$.
        \STATE If $||\gradg||_2 > C$: $\gradg = \gradg / C$.
        \STATE Grid search $\sigma(q, T, \eps, \delta)$ by finding minimal $\sigma$ that satisfies \eqref{eq:renyi_bound} and \eqref{eq:privacy_requirement} for some integer $\alpha \in [1,20]$.
        \STATE $\gradg_{priv}$ = $\gradg + \mathcal{N}(0,(C\sigma)^2\mathbb{I}^d)$
        \STATE \textbf{Output}: $sign(\gradg_{priv})$
    \end{algorithmic}
\end{algorithm} 