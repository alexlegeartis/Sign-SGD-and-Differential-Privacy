2025-05-17 12:14:38,497 - Created experiment directory: /home/legeartis/Sign-SGD-and-Differential-Privacy/logs/1worker_30_2025-05-17_12-14-38
2025-05-17 12:14:38,497 - Logs will be saved to: /home/legeartis/Sign-SGD-and-Differential-Privacy/logs/1worker_30_2025-05-17_12-14-38/experiment2025-05-17_12-14-38.log
2025-05-17 12:14:38,497 - Config file backed up to: /home/legeartis/Sign-SGD-and-Differential-Privacy/logs/1worker_30_2025-05-17_12-14-38/config_2025-05-17_12-14-38.json
2025-05-17 12:14:38,633 - Using device: cuda
2025-05-17 12:14:38,633 - Loading mnist dataset
2025-05-17 12:14:38,852 - Number of gradients per iteration: 8
2025-05-17 12:14:38,853 - 
Running SignSGD (LR=0.01)...
2025-05-17 12:14:40,965 - 
Epoch 1/30
2025-05-17 12:14:49,357 - Test Loss: 2.5640
2025-05-17 12:14:49,357 - Test Accuracy: 13.72%
2025-05-17 12:14:49,357 - Learning rate: 0.001084
2025-05-17 12:14:49,357 - 
Epoch 2/30
2025-05-17 12:14:55,547 - Test Loss: 3.4726
2025-05-17 12:14:55,547 - Test Accuracy: 16.67%
2025-05-17 12:14:55,547 - Learning rate: 0.001707
2025-05-17 12:14:55,547 - 
Epoch 3/30
2025-05-17 12:15:01,753 - Test Loss: 2.1585
2025-05-17 12:15:01,754 - Test Accuracy: 31.25%
2025-05-17 12:15:01,754 - Learning rate: 0.001492
2025-05-17 12:15:01,754 - 
Epoch 4/30
2025-05-17 12:15:08,133 - Test Loss: 2.1600
2025-05-17 12:15:08,133 - Test Accuracy: 31.60%
2025-05-17 12:15:08,133 - Learning rate: 0.001356
2025-05-17 12:15:08,133 - 
Epoch 5/30
2025-05-17 12:15:14,307 - Test Loss: 1.9776
2025-05-17 12:15:14,307 - Test Accuracy: 35.84%
2025-05-17 12:15:14,307 - Learning rate: 0.001259
2025-05-17 12:15:14,307 - 
Epoch 6/30
2025-05-17 12:15:20,355 - Test Loss: 1.7931
2025-05-17 12:15:20,356 - Test Accuracy: 32.82%
2025-05-17 12:15:20,356 - Learning rate: 0.001185
2025-05-17 12:15:20,356 - 
Epoch 7/30
2025-05-17 12:15:26,691 - Test Loss: 1.8585
2025-05-17 12:15:26,692 - Test Accuracy: 40.19%
2025-05-17 12:15:26,692 - Learning rate: 0.001126
2025-05-17 12:15:26,692 - 
Epoch 8/30
2025-05-17 12:15:33,087 - Test Loss: 1.5499
2025-05-17 12:15:33,087 - Test Accuracy: 44.77%
2025-05-17 12:15:33,087 - Learning rate: 0.001077
2025-05-17 12:15:33,087 - 
Epoch 9/30
2025-05-17 12:15:39,491 - Test Loss: 1.2775
2025-05-17 12:15:39,491 - Test Accuracy: 56.85%
2025-05-17 12:15:39,491 - Learning rate: 0.001035
2025-05-17 12:15:39,491 - 
Epoch 10/30
2025-05-17 12:15:45,814 - Test Loss: 1.3358
2025-05-17 12:15:45,815 - Test Accuracy: 51.91%
2025-05-17 12:15:45,815 - Learning rate: 0.001000
2025-05-17 12:15:45,815 - 
Epoch 11/30
2025-05-17 12:15:52,040 - Test Loss: 1.1406
2025-05-17 12:15:52,040 - Test Accuracy: 62.89%
2025-05-17 12:15:52,040 - Learning rate: 0.000968
2025-05-17 12:15:52,040 - 
Epoch 12/30
2025-05-17 12:15:58,211 - Test Loss: 2.1807
2025-05-17 12:15:58,211 - Test Accuracy: 37.53%
2025-05-17 12:15:58,211 - Learning rate: 0.000941
2025-05-17 12:15:58,211 - 
Epoch 13/30
2025-05-17 12:16:04,383 - Test Loss: 1.2260
2025-05-17 12:16:04,383 - Test Accuracy: 63.01%
2025-05-17 12:16:04,383 - Learning rate: 0.000916
2025-05-17 12:16:04,383 - 
Epoch 14/30
2025-05-17 12:16:10,616 - Test Loss: 1.0380
2025-05-17 12:16:10,616 - Test Accuracy: 65.58%
2025-05-17 12:16:10,616 - Learning rate: 0.000894
2025-05-17 12:16:10,617 - 
Epoch 15/30
2025-05-17 12:16:16,913 - Test Loss: 1.3884
2025-05-17 12:16:16,914 - Test Accuracy: 56.23%
2025-05-17 12:16:16,914 - Learning rate: 0.000873
2025-05-17 12:16:16,914 - 
Epoch 16/30
2025-05-17 12:16:23,134 - Test Loss: 1.0063
2025-05-17 12:16:23,134 - Test Accuracy: 67.87%
2025-05-17 12:16:23,134 - Learning rate: 0.000855
2025-05-17 12:16:23,134 - 
Epoch 17/30
2025-05-17 12:16:29,352 - Test Loss: 1.5512
2025-05-17 12:16:29,352 - Test Accuracy: 57.12%
2025-05-17 12:16:29,353 - Learning rate: 0.000838
2025-05-17 12:16:29,353 - 
Epoch 18/30
2025-05-17 12:16:35,664 - Test Loss: 1.5755
2025-05-17 12:16:35,664 - Test Accuracy: 53.08%
2025-05-17 12:16:35,664 - Learning rate: 0.000822
2025-05-17 12:16:35,664 - 
Epoch 19/30
2025-05-17 12:16:41,792 - Test Loss: 0.7756
2025-05-17 12:16:41,792 - Test Accuracy: 74.74%
2025-05-17 12:16:41,792 - Learning rate: 0.000807
2025-05-17 12:16:41,792 - 
Epoch 20/30
2025-05-17 12:16:47,993 - Test Loss: 1.1384
2025-05-17 12:16:47,994 - Test Accuracy: 71.88%
2025-05-17 12:16:47,994 - Learning rate: 0.000794
2025-05-17 12:16:47,994 - 
Epoch 21/30
2025-05-17 12:16:54,373 - Test Loss: 0.7987
2025-05-17 12:16:54,374 - Test Accuracy: 77.39%
2025-05-17 12:16:54,374 - Learning rate: 0.000781
2025-05-17 12:16:54,374 - 
Epoch 22/30
2025-05-17 12:17:00,717 - Test Loss: 0.8113
2025-05-17 12:17:00,717 - Test Accuracy: 76.26%
2025-05-17 12:17:00,717 - Learning rate: 0.000769
2025-05-17 12:17:00,717 - 
Epoch 23/30
2025-05-17 12:17:07,105 - Test Loss: 0.8510
2025-05-17 12:17:07,105 - Test Accuracy: 76.00%
2025-05-17 12:17:07,105 - Learning rate: 0.000757
2025-05-17 12:17:07,105 - 
Epoch 24/30
2025-05-17 12:17:13,346 - Test Loss: 0.6924
2025-05-17 12:17:13,346 - Test Accuracy: 81.41%
2025-05-17 12:17:13,346 - Learning rate: 0.000747
2025-05-17 12:17:13,346 - 
Epoch 25/30
2025-05-17 12:17:19,601 - Test Loss: 0.7641
2025-05-17 12:17:19,601 - Test Accuracy: 81.00%
2025-05-17 12:17:19,601 - Learning rate: 0.000737
2025-05-17 12:17:19,601 - 
Epoch 26/30
2025-05-17 12:17:25,843 - Test Loss: 0.9709
2025-05-17 12:17:25,844 - Test Accuracy: 80.07%
2025-05-17 12:17:25,844 - Learning rate: 0.000727
2025-05-17 12:17:25,844 - 
Epoch 27/30
2025-05-17 12:17:32,106 - Test Loss: 0.8940
2025-05-17 12:17:32,106 - Test Accuracy: 81.68%
2025-05-17 12:17:32,107 - Learning rate: 0.000718
2025-05-17 12:17:32,107 - 
Epoch 28/30
2025-05-17 12:17:38,319 - Test Loss: 0.9357
2025-05-17 12:17:38,319 - Test Accuracy: 80.76%
2025-05-17 12:17:38,319 - Learning rate: 0.000709
2025-05-17 12:17:38,319 - 
Epoch 29/30
2025-05-17 12:17:44,741 - Test Loss: 0.8869
2025-05-17 12:17:44,742 - Test Accuracy: 81.48%
2025-05-17 12:17:44,742 - Learning rate: 0.000701
2025-05-17 12:17:44,742 - 
Epoch 30/30
2025-05-17 12:17:51,014 - Test Loss: 1.2052
2025-05-17 12:17:51,014 - Test Accuracy: 77.16%
2025-05-17 12:17:51,014 - Learning rate: 0.000693
2025-05-17 12:17:51,728 - 
Running DPSignSGD Short...
2025-05-17 12:17:52,242 - Sigma for DPSignSGD Short: 0.9
2025-05-17 12:17:54,599 - 
Epoch 1/20
2025-05-17 12:18:04,861 - Test Loss: 2.4235
2025-05-17 12:18:04,861 - Test Accuracy: 16.71%
2025-05-17 12:18:04,861 - Learning rate: 0.001084
2025-05-17 12:18:04,861 - 
Epoch 2/20
2025-05-17 12:18:12,617 - Test Loss: 2.2269
2025-05-17 12:18:12,617 - Test Accuracy: 19.79%
2025-05-17 12:18:12,618 - Learning rate: 0.001707
2025-05-17 12:18:12,618 - 
Epoch 3/20
2025-05-17 12:18:20,268 - Test Loss: 2.3011
2025-05-17 12:18:20,268 - Test Accuracy: 22.49%
2025-05-17 12:18:20,268 - Learning rate: 0.001492
2025-05-17 12:18:20,268 - 
Epoch 4/20
2025-05-17 12:18:28,171 - Test Loss: 2.2124
2025-05-17 12:18:28,171 - Test Accuracy: 23.39%
2025-05-17 12:18:28,171 - Learning rate: 0.001356
2025-05-17 12:18:28,171 - 
Epoch 5/20
2025-05-17 12:18:36,029 - Test Loss: 2.1817
2025-05-17 12:18:36,029 - Test Accuracy: 24.39%
2025-05-17 12:18:36,030 - Learning rate: 0.001259
2025-05-17 12:18:36,030 - 
Epoch 6/20
2025-05-17 12:18:43,692 - Test Loss: 2.1917
2025-05-17 12:18:43,692 - Test Accuracy: 26.38%
2025-05-17 12:18:43,692 - Learning rate: 0.001185
2025-05-17 12:18:43,692 - 
Epoch 7/20
2025-05-17 12:18:51,260 - Test Loss: 2.1910
2025-05-17 12:18:51,260 - Test Accuracy: 23.27%
2025-05-17 12:18:51,260 - Learning rate: 0.001126
2025-05-17 12:18:51,260 - 
Epoch 8/20
2025-05-17 12:18:58,915 - Test Loss: 2.1633
2025-05-17 12:18:58,916 - Test Accuracy: 20.57%
2025-05-17 12:18:58,916 - Learning rate: 0.001077
2025-05-17 12:18:58,916 - 
Epoch 9/20
2025-05-17 12:19:06,675 - Test Loss: 2.0752
2025-05-17 12:19:06,675 - Test Accuracy: 24.32%
2025-05-17 12:19:06,675 - Learning rate: 0.001035
2025-05-17 12:19:06,675 - 
Epoch 10/20
2025-05-17 12:19:14,458 - Test Loss: 2.0032
2025-05-17 12:19:14,458 - Test Accuracy: 31.24%
2025-05-17 12:19:14,458 - Learning rate: 0.001000
2025-05-17 12:19:14,458 - 
Epoch 11/20
2025-05-17 12:19:22,327 - Test Loss: 1.9620
2025-05-17 12:19:22,327 - Test Accuracy: 34.43%
2025-05-17 12:19:22,327 - Learning rate: 0.000968
2025-05-17 12:19:22,327 - 
Epoch 12/20
2025-05-17 12:19:30,181 - Test Loss: 1.9924
2025-05-17 12:19:30,181 - Test Accuracy: 34.62%
2025-05-17 12:19:30,182 - Learning rate: 0.000941
2025-05-17 12:19:30,182 - 
Epoch 13/20
2025-05-17 12:19:37,876 - Test Loss: 1.9837
2025-05-17 12:19:37,876 - Test Accuracy: 33.52%
2025-05-17 12:19:37,876 - Learning rate: 0.000916
2025-05-17 12:19:37,876 - 
Epoch 14/20
2025-05-17 12:19:46,314 - Test Loss: 1.8983
2025-05-17 12:19:46,314 - Test Accuracy: 38.03%
2025-05-17 12:19:46,314 - Learning rate: 0.000894
2025-05-17 12:19:46,314 - 
Epoch 15/20
2025-05-17 12:19:54,717 - Test Loss: 1.8815
2025-05-17 12:19:54,718 - Test Accuracy: 38.40%
2025-05-17 12:19:54,718 - Learning rate: 0.000873
2025-05-17 12:19:54,718 - 
Epoch 16/20
2025-05-17 12:20:02,532 - Test Loss: 1.8793
2025-05-17 12:20:02,533 - Test Accuracy: 35.15%
2025-05-17 12:20:02,533 - Learning rate: 0.000855
2025-05-17 12:20:02,533 - 
Epoch 17/20
2025-05-17 12:20:10,289 - Test Loss: 1.8826
2025-05-17 12:20:10,289 - Test Accuracy: 35.83%
2025-05-17 12:20:10,289 - Learning rate: 0.000838
2025-05-17 12:20:10,289 - 
Epoch 18/20
2025-05-17 12:20:18,164 - Test Loss: 1.8505
2025-05-17 12:20:18,164 - Test Accuracy: 37.06%
2025-05-17 12:20:18,164 - Learning rate: 0.000822
2025-05-17 12:20:18,164 - 
Epoch 19/20
2025-05-17 12:20:26,083 - Test Loss: 1.8424
2025-05-17 12:20:26,083 - Test Accuracy: 37.42%
2025-05-17 12:20:26,083 - Learning rate: 0.000807
2025-05-17 12:20:26,084 - 
Epoch 20/20
2025-05-17 12:20:34,122 - Test Loss: 1.8717
2025-05-17 12:20:34,122 - Test Accuracy: 36.99%
2025-05-17 12:20:34,122 - Learning rate: 0.000794
2025-05-17 12:20:34,752 - 
Running DPSignSGD Long...
2025-05-17 12:20:35,117 - Sigma for DPSignSGD Long: 0.5
2025-05-17 12:20:37,455 - 
Epoch 1/200
2025-05-17 12:20:48,044 - Test Loss: 2.8116
2025-05-17 12:20:48,045 - Test Accuracy: 9.38%
2025-05-17 12:20:48,045 - Learning rate: 0.000116
2025-05-17 12:20:48,045 - 
Epoch 2/200
2025-05-17 12:20:56,041 - Test Loss: 2.7281
2025-05-17 12:20:56,041 - Test Accuracy: 8.93%
2025-05-17 12:20:56,041 - Learning rate: 0.000219
2025-05-17 12:20:56,041 - 
Epoch 3/200
2025-05-17 12:21:04,007 - Test Loss: 2.6635
2025-05-17 12:21:04,007 - Test Accuracy: 8.52%
2025-05-17 12:21:04,007 - Learning rate: 0.000317
2025-05-17 12:21:04,007 - 
Epoch 4/200
2025-05-17 12:21:12,057 - Test Loss: 2.6517
2025-05-17 12:21:12,058 - Test Accuracy: 9.35%
2025-05-17 12:21:12,058 - Learning rate: 0.000310
2025-05-17 12:21:12,058 - 
Epoch 5/200
2025-05-17 12:21:20,580 - Test Loss: 2.7203
2025-05-17 12:21:20,580 - Test Accuracy: 9.51%
2025-05-17 12:21:20,580 - Learning rate: 0.000304
2025-05-17 12:21:20,580 - 
Epoch 6/200
2025-05-17 12:21:28,880 - Test Loss: 2.7126
2025-05-17 12:21:28,881 - Test Accuracy: 9.28%
2025-05-17 12:21:28,881 - Learning rate: 0.000300
2025-05-17 12:21:28,881 - 
Epoch 7/200
2025-05-17 12:21:36,951 - Test Loss: 2.7024
2025-05-17 12:21:36,951 - Test Accuracy: 9.47%
2025-05-17 12:21:36,951 - Learning rate: 0.000296
2025-05-17 12:21:36,951 - 
Epoch 8/200
2025-05-17 12:21:45,053 - Test Loss: 2.6560
2025-05-17 12:21:45,054 - Test Accuracy: 9.48%
2025-05-17 12:21:45,054 - Learning rate: 0.000293
2025-05-17 12:21:45,054 - 
Epoch 9/200
2025-05-17 12:21:52,945 - Test Loss: 2.6208
2025-05-17 12:21:52,946 - Test Accuracy: 9.44%
2025-05-17 12:21:52,946 - Learning rate: 0.000290
2025-05-17 12:21:52,946 - 
Epoch 10/200
2025-05-17 12:22:00,939 - Test Loss: 2.6066
2025-05-17 12:22:00,939 - Test Accuracy: 9.48%
2025-05-17 12:22:00,939 - Learning rate: 0.000288
2025-05-17 12:22:00,939 - 
Epoch 11/200
2025-05-17 12:22:08,958 - Test Loss: 2.5779
2025-05-17 12:22:08,958 - Test Accuracy: 9.50%
2025-05-17 12:22:08,958 - Learning rate: 0.000286
2025-05-17 12:22:08,958 - 
Epoch 12/200
2025-05-17 12:22:16,828 - Test Loss: 2.5439
2025-05-17 12:22:16,829 - Test Accuracy: 9.53%
2025-05-17 12:22:16,829 - Learning rate: 0.000284
2025-05-17 12:22:16,829 - 
Epoch 13/200
2025-05-17 12:22:24,687 - Test Loss: 2.5482
2025-05-17 12:22:24,687 - Test Accuracy: 9.50%
2025-05-17 12:22:24,687 - Learning rate: 0.000282
2025-05-17 12:22:24,687 - 
Epoch 14/200
2025-05-17 12:22:32,712 - Test Loss: 2.5314
2025-05-17 12:22:32,712 - Test Accuracy: 9.62%
2025-05-17 12:22:32,712 - Learning rate: 0.000280
2025-05-17 12:22:32,712 - 
Epoch 15/200
2025-05-17 12:22:40,926 - Test Loss: 2.5340
2025-05-17 12:22:40,926 - Test Accuracy: 9.62%
2025-05-17 12:22:40,926 - Learning rate: 0.000279
2025-05-17 12:22:40,926 - 
Epoch 16/200
2025-05-17 12:22:49,209 - Test Loss: 2.5151
2025-05-17 12:22:49,209 - Test Accuracy: 9.69%
2025-05-17 12:22:49,209 - Learning rate: 0.000277
2025-05-17 12:22:49,209 - 
Epoch 17/200
2025-05-17 12:22:57,627 - Test Loss: 2.5211
2025-05-17 12:22:57,627 - Test Accuracy: 9.68%
2025-05-17 12:22:57,627 - Learning rate: 0.000276
2025-05-17 12:22:57,627 - 
Epoch 18/200
2025-05-17 12:23:05,884 - Test Loss: 2.4827
2025-05-17 12:23:05,884 - Test Accuracy: 10.21%
2025-05-17 12:23:05,884 - Learning rate: 0.000274
2025-05-17 12:23:05,884 - 
Epoch 19/200
2025-05-17 12:23:13,938 - Test Loss: 2.5282
2025-05-17 12:23:13,938 - Test Accuracy: 10.18%
2025-05-17 12:23:13,938 - Learning rate: 0.000273
2025-05-17 12:23:13,938 - 
Epoch 20/200
2025-05-17 12:23:22,026 - Test Loss: 2.4936
2025-05-17 12:23:22,026 - Test Accuracy: 10.54%
2025-05-17 12:23:22,026 - Learning rate: 0.000272
2025-05-17 12:23:22,026 - 
Epoch 21/200
2025-05-17 12:23:30,120 - Test Loss: 2.5244
2025-05-17 12:23:30,120 - Test Accuracy: 10.31%
2025-05-17 12:23:30,120 - Learning rate: 0.000271
2025-05-17 12:23:30,120 - 
Epoch 22/200
2025-05-17 12:23:38,168 - Test Loss: 2.5105
2025-05-17 12:23:38,169 - Test Accuracy: 10.22%
2025-05-17 12:23:38,169 - Learning rate: 0.000270
2025-05-17 12:23:38,169 - 
Epoch 23/200
2025-05-17 12:23:46,287 - Test Loss: 2.5265
2025-05-17 12:23:46,287 - Test Accuracy: 10.09%
2025-05-17 12:23:46,287 - Learning rate: 0.000269
2025-05-17 12:23:46,287 - 
Epoch 24/200
2025-05-17 12:23:54,276 - Test Loss: 2.5038
2025-05-17 12:23:54,276 - Test Accuracy: 9.62%
2025-05-17 12:23:54,276 - Learning rate: 0.000268
2025-05-17 12:23:54,277 - 
Epoch 25/200
