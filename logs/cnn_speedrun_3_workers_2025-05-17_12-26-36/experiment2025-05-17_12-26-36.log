2025-05-17 12:26:36,219 - Created experiment directory: /home/legeartis/Sign-SGD-and-Differential-Privacy/logs/cnn_speedrun_3_workers_2025-05-17_12-26-36
2025-05-17 12:26:36,219 - Logs will be saved to: /home/legeartis/Sign-SGD-and-Differential-Privacy/logs/cnn_speedrun_3_workers_2025-05-17_12-26-36/experiment2025-05-17_12-26-36.log
2025-05-17 12:26:36,219 - Config file backed up to: /home/legeartis/Sign-SGD-and-Differential-Privacy/logs/cnn_speedrun_3_workers_2025-05-17_12-26-36/config_2025-05-17_12-26-36.json
2025-05-17 12:26:36,351 - Using device: cuda
2025-05-17 12:26:36,351 - Loading mnist dataset
2025-05-17 12:26:36,543 - Number of gradients per iteration: 8
2025-05-17 12:26:36,544 - 
Running SignSGD (LR=0.01)...
2025-05-17 12:26:36,669 - 
Epoch 1/30
2025-05-17 12:26:48,396 - Test Loss: 2.3509
2025-05-17 12:26:48,396 - Test Accuracy: 11.90%
2025-05-17 12:26:48,396 - Learning rate: 0.001084
2025-05-17 12:26:48,396 - 
Epoch 2/30
2025-05-17 12:26:56,874 - Test Loss: 2.0307
2025-05-17 12:26:56,874 - Test Accuracy: 34.14%
2025-05-17 12:26:56,874 - Learning rate: 0.001707
2025-05-17 12:26:56,874 - 
Epoch 3/30
2025-05-17 12:27:05,260 - Test Loss: 1.6333
2025-05-17 12:27:05,260 - Test Accuracy: 50.49%
2025-05-17 12:27:05,260 - Learning rate: 0.001492
2025-05-17 12:27:05,260 - 
Epoch 4/30
2025-05-17 12:27:14,067 - Test Loss: 1.2326
2025-05-17 12:27:14,067 - Test Accuracy: 54.52%
2025-05-17 12:27:14,067 - Learning rate: 0.001356
2025-05-17 12:27:14,067 - 
Epoch 5/30
2025-05-17 12:27:22,634 - Test Loss: 2.0621
2025-05-17 12:27:22,634 - Test Accuracy: 44.12%
2025-05-17 12:27:22,634 - Learning rate: 0.001259
2025-05-17 12:27:22,634 - 
Epoch 6/30
2025-05-17 12:27:31,189 - Test Loss: 0.6077
2025-05-17 12:27:31,189 - Test Accuracy: 81.91%
2025-05-17 12:27:31,189 - Learning rate: 0.001185
2025-05-17 12:27:31,189 - 
Epoch 7/30
2025-05-17 12:27:39,742 - Test Loss: 0.6850
2025-05-17 12:27:39,742 - Test Accuracy: 77.06%
2025-05-17 12:27:39,742 - Learning rate: 0.001126
2025-05-17 12:27:39,742 - 
Epoch 8/30
2025-05-17 12:27:48,290 - Test Loss: 1.3309
2025-05-17 12:27:48,290 - Test Accuracy: 69.84%
2025-05-17 12:27:48,290 - Learning rate: 0.001077
2025-05-17 12:27:48,291 - 
Epoch 9/30
2025-05-17 12:27:56,853 - Test Loss: 0.6720
2025-05-17 12:27:56,853 - Test Accuracy: 82.14%
2025-05-17 12:27:56,853 - Learning rate: 0.001035
2025-05-17 12:27:56,853 - 
Epoch 10/30
2025-05-17 12:28:05,500 - Test Loss: 1.0839
2025-05-17 12:28:05,500 - Test Accuracy: 79.30%
2025-05-17 12:28:05,500 - Learning rate: 0.001000
2025-05-17 12:28:05,500 - 
Epoch 11/30
2025-05-17 12:28:13,968 - Test Loss: 0.7507
2025-05-17 12:28:13,969 - Test Accuracy: 84.39%
2025-05-17 12:28:13,969 - Learning rate: 0.000968
2025-05-17 12:28:13,969 - 
Epoch 12/30
2025-05-17 12:28:22,481 - Test Loss: 1.0838
2025-05-17 12:28:22,482 - Test Accuracy: 78.57%
2025-05-17 12:28:22,482 - Learning rate: 0.000941
2025-05-17 12:28:22,482 - 
Epoch 13/30
2025-05-17 12:28:31,006 - Test Loss: 0.9494
2025-05-17 12:28:31,007 - Test Accuracy: 82.91%
2025-05-17 12:28:31,007 - Learning rate: 0.000916
2025-05-17 12:28:31,007 - 
Epoch 14/30
2025-05-17 12:28:39,511 - Test Loss: 0.8138
2025-05-17 12:28:39,511 - Test Accuracy: 83.51%
2025-05-17 12:28:39,511 - Learning rate: 0.000894
2025-05-17 12:28:39,511 - 
Epoch 15/30
2025-05-17 12:28:48,075 - Test Loss: 0.8115
2025-05-17 12:28:48,075 - Test Accuracy: 84.56%
2025-05-17 12:28:48,075 - Learning rate: 0.000873
2025-05-17 12:28:48,075 - 
Epoch 16/30
2025-05-17 12:28:56,651 - Test Loss: 1.1558
2025-05-17 12:28:56,651 - Test Accuracy: 81.32%
2025-05-17 12:28:56,652 - Learning rate: 0.000855
2025-05-17 12:28:56,652 - 
Epoch 17/30
2025-05-17 12:29:05,414 - Test Loss: 0.6772
2025-05-17 12:29:05,414 - Test Accuracy: 83.96%
2025-05-17 12:29:05,414 - Learning rate: 0.000838
2025-05-17 12:29:05,414 - 
Epoch 18/30
2025-05-17 12:29:14,220 - Test Loss: 1.0624
2025-05-17 12:29:14,220 - Test Accuracy: 79.24%
2025-05-17 12:29:14,220 - Learning rate: 0.000822
2025-05-17 12:29:14,220 - 
Epoch 19/30
2025-05-17 12:29:22,835 - Test Loss: 0.8387
2025-05-17 12:29:22,836 - Test Accuracy: 84.93%
2025-05-17 12:29:22,836 - Learning rate: 0.000807
2025-05-17 12:29:22,836 - 
Epoch 20/30
2025-05-17 12:29:31,384 - Test Loss: 0.7362
2025-05-17 12:29:31,384 - Test Accuracy: 86.56%
2025-05-17 12:29:31,384 - Learning rate: 0.000794
2025-05-17 12:29:31,384 - 
Epoch 21/30
2025-05-17 12:29:39,920 - Test Loss: 0.9429
2025-05-17 12:29:39,920 - Test Accuracy: 84.86%
2025-05-17 12:29:39,920 - Learning rate: 0.000781
2025-05-17 12:29:39,920 - 
Epoch 22/30
2025-05-17 12:29:48,549 - Test Loss: 1.2792
2025-05-17 12:29:48,550 - Test Accuracy: 81.84%
2025-05-17 12:29:48,550 - Learning rate: 0.000769
2025-05-17 12:29:48,550 - 
Epoch 23/30
2025-05-17 12:29:57,304 - Test Loss: 0.9268
2025-05-17 12:29:57,305 - Test Accuracy: 83.97%
2025-05-17 12:29:57,305 - Learning rate: 0.000757
2025-05-17 12:29:57,305 - 
Epoch 24/30
2025-05-17 12:30:05,819 - Test Loss: 1.5862
2025-05-17 12:30:05,820 - Test Accuracy: 77.18%
2025-05-17 12:30:05,820 - Learning rate: 0.000747
2025-05-17 12:30:05,820 - 
Epoch 25/30
2025-05-17 12:30:14,377 - Test Loss: 1.0517
2025-05-17 12:30:14,377 - Test Accuracy: 82.91%
2025-05-17 12:30:14,377 - Learning rate: 0.000737
2025-05-17 12:30:14,377 - 
Epoch 26/30
2025-05-17 12:30:22,997 - Test Loss: 1.2432
2025-05-17 12:30:22,997 - Test Accuracy: 79.98%
2025-05-17 12:30:22,998 - Learning rate: 0.000727
2025-05-17 12:30:22,998 - 
Epoch 27/30
2025-05-17 12:30:31,639 - Test Loss: 0.8060
2025-05-17 12:30:31,639 - Test Accuracy: 82.67%
2025-05-17 12:30:31,639 - Learning rate: 0.000718
2025-05-17 12:30:31,639 - 
Epoch 28/30
2025-05-17 12:30:40,281 - Test Loss: 0.6545
2025-05-17 12:30:40,281 - Test Accuracy: 85.67%
2025-05-17 12:30:40,281 - Learning rate: 0.000709
2025-05-17 12:30:40,281 - 
Epoch 29/30
2025-05-17 12:30:48,846 - Test Loss: 0.4613
2025-05-17 12:30:48,846 - Test Accuracy: 88.33%
2025-05-17 12:30:48,846 - Learning rate: 0.000701
2025-05-17 12:30:48,846 - 
Epoch 30/30
2025-05-17 12:30:57,510 - Test Loss: 0.8464
2025-05-17 12:30:57,510 - Test Accuracy: 84.97%
2025-05-17 12:30:57,510 - Learning rate: 0.000693
2025-05-17 12:30:58,236 - 
Running DPSignSGD Short...
2025-05-17 12:30:58,732 - Sigma for DPSignSGD Short: 1.6
2025-05-17 12:30:58,747 - Sigma for DPSignSGD Short: 1.6
2025-05-17 12:30:58,751 - Sigma for DPSignSGD Short: 1.6
2025-05-17 12:30:58,843 - 
Epoch 1/20
2025-05-17 12:31:12,190 - Test Loss: 2.4380
2025-05-17 12:31:12,191 - Test Accuracy: 18.11%
2025-05-17 12:31:12,191 - Learning rate: 0.001084
2025-05-17 12:31:12,191 - 
Epoch 2/20
2025-05-17 12:31:22,129 - Test Loss: 2.3729
2025-05-17 12:31:22,130 - Test Accuracy: 21.77%
2025-05-17 12:31:22,130 - Learning rate: 0.001707
2025-05-17 12:31:22,130 - 
Epoch 3/20
2025-05-17 12:31:32,008 - Test Loss: 2.3956
2025-05-17 12:31:32,009 - Test Accuracy: 19.40%
2025-05-17 12:31:32,009 - Learning rate: 0.001492
2025-05-17 12:31:32,009 - 
Epoch 4/20
2025-05-17 12:31:42,178 - Test Loss: 2.4343
2025-05-17 12:31:42,179 - Test Accuracy: 17.57%
2025-05-17 12:31:42,179 - Learning rate: 0.001356
2025-05-17 12:31:42,179 - 
Epoch 5/20
2025-05-17 12:31:52,151 - Test Loss: 2.2585
2025-05-17 12:31:52,152 - Test Accuracy: 13.40%
2025-05-17 12:31:52,152 - Learning rate: 0.001259
2025-05-17 12:31:52,152 - 
Epoch 6/20
2025-05-17 12:32:02,007 - Test Loss: 2.2823
2025-05-17 12:32:02,008 - Test Accuracy: 15.19%
2025-05-17 12:32:02,008 - Learning rate: 0.001185
2025-05-17 12:32:02,008 - 
Epoch 7/20
2025-05-17 12:32:11,823 - Test Loss: 2.2655
2025-05-17 12:32:11,823 - Test Accuracy: 11.82%
2025-05-17 12:32:11,824 - Learning rate: 0.001126
2025-05-17 12:32:11,824 - 
Epoch 8/20
2025-05-17 12:32:21,565 - Test Loss: 2.3159
2025-05-17 12:32:21,565 - Test Accuracy: 12.83%
2025-05-17 12:32:21,565 - Learning rate: 0.001077
2025-05-17 12:32:21,565 - 
Epoch 9/20
2025-05-17 12:32:31,483 - Test Loss: 2.2932
2025-05-17 12:32:31,483 - Test Accuracy: 13.85%
2025-05-17 12:32:31,483 - Learning rate: 0.001035
2025-05-17 12:32:31,483 - 
Epoch 10/20
2025-05-17 12:32:41,461 - Test Loss: 2.2860
2025-05-17 12:32:41,461 - Test Accuracy: 14.16%
2025-05-17 12:32:41,461 - Learning rate: 0.001000
2025-05-17 12:32:41,461 - 
Epoch 11/20
2025-05-17 12:32:51,415 - Test Loss: 2.2996
2025-05-17 12:32:51,415 - Test Accuracy: 17.64%
2025-05-17 12:32:51,415 - Learning rate: 0.000968
2025-05-17 12:32:51,415 - 
Epoch 12/20
2025-05-17 12:33:01,620 - Test Loss: 2.2436
2025-05-17 12:33:01,620 - Test Accuracy: 15.98%
2025-05-17 12:33:01,620 - Learning rate: 0.000941
2025-05-17 12:33:01,620 - 
Epoch 13/20
2025-05-17 12:33:11,694 - Test Loss: 2.1736
2025-05-17 12:33:11,694 - Test Accuracy: 19.35%
2025-05-17 12:33:11,694 - Learning rate: 0.000916
2025-05-17 12:33:11,694 - 
Epoch 14/20
2025-05-17 12:33:21,777 - Test Loss: 2.0987
2025-05-17 12:33:21,777 - Test Accuracy: 24.17%
2025-05-17 12:33:21,777 - Learning rate: 0.000894
2025-05-17 12:33:21,777 - 
Epoch 15/20
2025-05-17 12:33:31,809 - Test Loss: 2.1483
2025-05-17 12:33:31,809 - Test Accuracy: 19.94%
2025-05-17 12:33:31,809 - Learning rate: 0.000873
2025-05-17 12:33:31,809 - 
Epoch 16/20
2025-05-17 12:33:41,858 - Test Loss: 2.1173
2025-05-17 12:33:41,859 - Test Accuracy: 21.31%
2025-05-17 12:33:41,859 - Learning rate: 0.000855
2025-05-17 12:33:41,859 - 
Epoch 17/20
2025-05-17 12:33:52,040 - Test Loss: 2.1057
2025-05-17 12:33:52,040 - Test Accuracy: 26.13%
2025-05-17 12:33:52,040 - Learning rate: 0.000838
2025-05-17 12:33:52,040 - 
Epoch 18/20
2025-05-17 12:34:02,259 - Test Loss: 2.1326
2025-05-17 12:34:02,260 - Test Accuracy: 24.57%
2025-05-17 12:34:02,260 - Learning rate: 0.000822
2025-05-17 12:34:02,260 - 
Epoch 19/20
2025-05-17 12:34:12,629 - Test Loss: 2.1229
2025-05-17 12:34:12,629 - Test Accuracy: 24.52%
2025-05-17 12:34:12,629 - Learning rate: 0.000807
2025-05-17 12:34:12,629 - 
Epoch 20/20
2025-05-17 12:34:22,946 - Test Loss: 2.1678
2025-05-17 12:34:22,947 - Test Accuracy: 22.89%
2025-05-17 12:34:22,947 - Learning rate: 0.000794
2025-05-17 12:34:24,502 - Plots saved in '/home/legeartis/Sign-SGD-and-Differential-Privacy/figs' directory
2025-05-17 12:34:24,502 - 
Final Results:
2025-05-17 12:34:24,502 - SignSGD (LR=0.01):
2025-05-17 12:34:24,502 -   Final Test Accuracy: 84.97%
2025-05-17 12:34:24,502 - DPSignSGD Short:
2025-05-17 12:34:24,502 -   Final Test Accuracy: 22.89%
2025-05-17 12:34:24,502 - Log file saved in '/home/legeartis/Sign-SGD-and-Differential-Privacy/logs/cnn_speedrun_3_workers_2025-05-17_12-26-36'
